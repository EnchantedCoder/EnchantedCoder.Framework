<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <!-- CodeGenerator, přestože sám je implementován jako NET Core App 3.0, chceme umožnit nainstalovat do projektů targetující .NET Standard 2.0. -->
    <TargetFramework>netstandard2.0</TargetFramework>
  </PropertyGroup>

  <!-- NuGet -->
  <Import Project="../NuGet.targets" />
  <PropertyGroup>
    <PackageId>Havit.Data.EntityFrameworkCore.CodeGenerator</PackageId>
    <PackageVersion>2.1.3</PackageVersion>
    <!-- Publikujeme výstup buildu jiného projektu. -->
    <IncludeBuildOutput>false</IncludeBuildOutput>
	<!-- Projects which set IncludeBuildOutput=false are likely to hit NU5128 - https://github.com/NuGet/Home/issues/8583 -->
	<NoWarn>$(NoWarn);NU5128</NoWarn>	  
    <Description>HAVIT .NET Framework Extensions - Entity Framework Core Extensions - Code Generator</Description>
  </PropertyGroup>

  <ItemGroup>
    <Content Include="..\Havit.Data.EntityFrameworkCore.CodeGenerator\bin\$(Configuration)\netcoreapp3.0\**">
      <Pack>true</Pack>
      <PackagePath>tools\CodeGenerator</PackagePath>
    </Content>
  </ItemGroup>

  <Target Name="NuspecCreationWorkaround" BeforeTargets="GenerateNuspec" AfterTargets="_CalculateInputsOutputsForPack">
    <!-- Workaround for "The DateTimeOffset specified cannot be converted into a Zip file timestamp." -->
    <!-- https://github.com/NuGet/Home/issues/7001 -->
		
    <!-- Soubory z MS nuget balíčků nemají datum vytvoření (resp. 1980-01-01). Takovýmto souborům se Nuspec brání v kladné časové zóně (asi nějaká chyba při posunu data do UTC nebo něco podobného) -->
    <!-- Proto souborům, které máme zabalit do nuget balíčku, nastavíme aktuální datum a čas. -->
    <Touch Files="@(_PackageFiles)" />
  </Target>
</Project>
